<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sancho Tech | Pair Code</title>
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <script src="https://cdn.jsdelivr.net/npm/particles.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.0.0-alpha.1/axios.min.js"></script>
  <style>
    :root {
      --primary: #1e3a8a; /* dark blue */
      --secondary: #3b82f6; /* light blue */
      --accent: #9333ea; /* lil purple */
      --dark: #0a0f1a;
      --light: #f8f9fa;
      --glass: rgba(255,255,255,0.08);
      --border: rgba(255,255,255,0.2);
      --transition: all .25s ease;
    }
    * {margin:0;padding:0;box-sizing:border-box;font-family:system-ui,Arial,sans-serif;}
    body {
      background: var(--dark);
      color: var(--light);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      line-height: 1.5;
      transition: var(--transition);
    }
    body.light { 
      background: var(--light); 
      color: #111; 
    }

    /* Particles background */
    #particles-js {position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;}

    /* Navbar */
    .navbar {
      background: var(--glass);
      backdrop-filter: blur(12px);
      padding: .8rem 1.2rem;
      display:flex;justify-content:space-between;align-items:center;
      position:sticky;top:0;z-index:10;
      border-bottom:1px solid var(--border);
    }
    .logo {
      font-size:1.4rem;font-weight:700;
      background:linear-gradient(90deg,var(--primary),var(--secondary),var(--accent));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      text-decoration:none;
      display:flex;align-items:center;gap:.5rem;
    }
    .toggle-theme {cursor:pointer;font-size:1.2rem;color:var(--secondary);}

    /* Hero */
    .hero {padding:6rem 1rem 2rem;text-align:center;}
    .hero h1 {
      font-size:2.5rem;
      background:linear-gradient(90deg,var(--primary),var(--secondary),var(--accent));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      margin-bottom:1rem;
    }
    .hero p {font-size:1.1rem;opacity:0.85;}

    /* Pair Section */
    .pair-section {flex:1;display:flex;align-items:center;justify-content:center;padding:2rem;}
    .pair-card {
      width:100%;max-width:420px;padding:2rem;
      background:var(--glass);backdrop-filter:blur(16px);
      border:1px solid var(--border);border-radius:16px;
      box-shadow:0 8px 24px rgba(0,0,0,.4);
      animation:fadeIn .6s ease;
      transition: var(--transition);
    }
    body.light .pair-card {
      background:rgba(0,0,0,0.05);
      border:1px solid rgba(0,0,0,0.2);
      box-shadow:0 8px 24px rgba(0,0,0,.15);
    }
    .pair-card h2 {
      text-align:center;
      background:linear-gradient(90deg,var(--primary),var(--secondary),var(--accent));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      margin-bottom:1rem;
    }
    .pair-card label {display:block;margin:.5rem 0 .3rem;}
    .pair-card input {
      width:100%;padding:.8rem;border-radius:8px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.1);
      color:inherit;margin-bottom:1rem;
      transition: var(--transition);
    }
    body.light .pair-card input {
      background:rgba(0,0,0,.05);
      border:1px solid rgba(0,0,0,0.2);
      color:#111;
    }

    /* Buttons */
    .btn {
      width:100%;padding:.8rem;margin-top:.5rem;
      border:none;border-radius:8px;cursor:pointer;
      background:linear-gradient(90deg,var(--primary),var(--secondary),var(--accent));
      color:#fff;font-weight:600;
      transition:var(--transition);
    }
    .btn:hover {transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.3);}
    .btn.secondary {
      background:transparent;
      border:2px solid var(--secondary);
      color:var(--secondary);
    }
    body.light .btn.secondary {
      border:2px solid var(--primary);
      color:var(--primary);
    }
    .hidden {display:none;}

    #pair {margin-top:1rem;text-align:center;word-wrap:break-word;}
    #loading {text-align:center;margin-top:1rem;}

    /* Footer */
    footer {
      text-align:center;
      padding:1rem;
      font-size:.9rem;
      opacity:.8;
    }

    @keyframes fadeIn {from{opacity:0;transform:translateY(15px);}to{opacity:1;transform:none;}}
  </style>
</head>
<body>
  <div id="particles-js"></div>

  <nav class="navbar">
    <a href="#" class="logo"><i class="fas fa-robot"></i> SANCHO XMD</a>
    <i class="fas fa-adjust toggle-theme" id="themeToggle"></i>
  </nav>

  <section class="hero">
    <h1>SANCHO TECH</h1>
    <p>Generate your WhatsApp SESSION_ID.</p>
  </section>

  <section class="pair-section">
    <div class="pair-card">
      <h2>Pair Code</h2>
      <label for="phone">Phone Number</label>
      <input type="text" id="phone" placeholder="+26378xxx">
      <button class="btn" id="generate">Get Code & Link</button>
      <button class="btn secondary hidden" id="validate">Validate Session</button>
      <button class="btn hidden" id="copy">Copy Code</button>
      <div id="loading" class="hidden"> Generating...</div>
      <div id="pair"></div>
    </div>
  </section>

  <footer>&copy; <span id="year"></span> Keith Tech. All rights reserved.</footer>

  <script>
    // Particles
    particlesJS("particles-js", {
      particles: {number:{value:50},color:{value:"#3b82f6"},size:{value:2},line_linked:{enable:true,color:"#3b82f6"},move:{enable:true,speed:1}},
      interactivity:{events:{onhover:{enable:true,mode:"grab"}},modes:{grab:{distance:200,line_linked:{opacity:.6}}}}
    });

    // Theme toggle
    const themeBtn=document.getElementById("themeToggle");
    themeBtn.onclick=()=>document.body.classList.toggle("light");

    // Year
    document.getElementById("year").textContent=new Date().getFullYear();

    // Pair code logic
    const phone=document.getElementById("phone");
    const gen=document.getElementById("generate");
    const val=document.getElementById("validate");
    const copy=document.getElementById("copy");
    const pair=document.getElementById("pair");
    const loading=document.getElementById("loading");

    gen.onclick=async()=>{
      let num=phone.value.replace(/\D/g,"");
      if(!num){pair.textContent="❗ Enter phone with country code";return;}
      loading.classList.remove("hidden");pair.textContent="";gen.disabled=true;
      try{
        phone.value="+"+num;
        await new Promise(r=>setTimeout(r,1200)); // simulate
        const {data}=await axios.get(`/code?number=${num}`);
        const code=data.code||"Unavailable";
        const link=`https://wa.me/${num}?text=${encodeURIComponent(code)}`;
        pair.innerHTML=`<p><b>${code}</b></p><p><a href="${link}" target="_blank">Open WhatsApp</a></p>`;
        copy.dataset.code=code;copy.classList.remove("hidden");val.classList.remove("hidden");
      }catch(e){pair.textContent="❗ Error. Try later.";}
      finally{loading.classList.add("hidden");gen.disabled=false;}
    };

    copy.onclick=async()=>{
      try{await navigator.clipboard.writeText(copy.dataset.code);
        copy.textContent="Copied!";setTimeout(()=>copy.textContent="Copy Code",2000);}
      catch(e){alert("Copy failed");}
    };
    val.onclick=()=>window.location.href="/validate";
  </script>
</body>
</html>